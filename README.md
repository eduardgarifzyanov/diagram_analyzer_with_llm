# Diagram Analyzer

> –î–≤—É–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ **–¥–∏–∞–≥—Ä–∞–º–º –ø—Ä–æ—Ü–µ—Å—Å–æ–≤** –∏ **—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º LLM, FastAPI –∏ PlantUML.

**Diagram Analyzer** ‚Äî —ç—Ç–æ –ª—ë–≥–∫–∏–π AI‚Äë—Å–µ—Ä–≤–∏—Å, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç:

* –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å **–¥–∏–∞–≥—Ä–∞–º–º—ã ‚Üí —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã**
* –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å **CSV‚Äë–∞–ª–≥–æ—Ä–∏—Ç–º—ã ‚Üí –≤–∏–∑—É–∞–ª—å–Ω—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã (PNG)**
* –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **OpenAI‚Äë—Å–æ–≤–º–µ—Å—Ç–∏–º—É—é –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—É—é –º–æ–¥–µ–ª—å** –¥–ª—è —Å–º—ã—Å–ª–æ–≤–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
* –∑–∞–ø—É—Å–∫–∞—Ç—å –≥–æ—Ç–æ–≤—ã–π **Web UI + REST API** –≤ Docker –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ

---

# ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

## 1. Diagram ‚Üí Table (AI‚Äë–∞–Ω–∞–ª–∏–∑)

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏:

* –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: `png`, `jpg`, `jpeg`, `webp`
* —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã:

  * BPMN XML
  * draw.io XML
  * PlantUML
  * –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã

LLM –≤—ã–ø–æ–ª–Ω—è–µ—Ç:

* –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ **—ç–ª–µ–º–µ–Ω—Ç–æ–≤, —Ä–æ–ª–µ–π –∏ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤**
* –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ **—É—Å–ª–æ–≤–∏–π –∏ –ø–æ—Ä—è–¥–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**
* –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ **—á–∏—Å—Ç–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã** (Markdown/CSV)

–ò—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –º–æ–¥–µ–ª—å:

```
Qwen/Qwen3-VL-2B-Instruct
(OpenAI‚Äëcompatible endpoint)
```

---

## 2. CSV ‚Üí Diagram (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è PNG)

–ü–∞–π–ø–ª–∞–π–Ω –æ–±—Ä–∞–±–æ—Ç–∫–∏:

1. CSV —á–∏—Ç–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ **pandas**
2. –¢–∞–±–ª–∏—Ü–∞ —Å–µ—Ä–∏–∞–ª–∏–∑—É–µ—Ç—Å—è –≤ **–ª–∏–Ω–µ–π–Ω—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —à–∞–≥–æ–≤**
3. LLM –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç **–≤–∞–ª–∏–¥–Ω—ã–π PlantUML‚Äë–∫–æ–¥**
4. PlantUML —Ä–µ–Ω–¥–µ—Ä–∏—Ç **PNG‚Äë–¥–∏–∞–≥—Ä–∞–º–º—É**
5. PNG –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ API –≤ –≤–∏–¥–µ **Base64**

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:

* –∞–≤—Ç–æ‚Äë–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ **start / stop**
* **fallback‚Äë–¥–∏–∞–≥—Ä–∞–º–º–∞** –ø—Ä–∏ –æ—à–∏–±–∫–µ PlantUML
* –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞

---

# üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
Browser UI (HTML/JS)
        ‚îÇ
        ‚ñº
      FastAPI
        ‚îÇ
        ‚ñº
   –°–µ—Ä–≤–∏—Å –º–æ–¥–µ–ª–µ–π
   ‚îú‚îÄ CSV ‚Üí LLM ‚Üí PlantUML ‚Üí PNG
   ‚îî‚îÄ Diagram ‚Üí LLM ‚Üí –¢–∞–±–ª–∏—Ü–∞
        ‚îÇ
        ‚ñº
 OpenAI‚Äë—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π LLM endpoint
        ‚îÇ
        ‚ñº
   PlantUML Runtime (Java)
```

–¶–µ–ª–∏ –¥–∏–∑–∞–π–Ω–∞:

* **stateless‚Äëbackend**
* –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ **Docker‚Äë–¥–µ–ø–ª–æ—é**
* **–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π LLM**
* —á—ë—Ç–∫–æ–µ **—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ —Å–ª–æ—ë–≤**

---

# üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

## Docker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
docker compose up --build
```

–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:

* Python 3.10+
* Java (–¥–ª—è PlantUML)
* —Ñ–∞–π–ª:

```
/runtime/plantuml.jar
```

–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤:

```
/runtime/output
```

---

## –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫

```bash
pip install -r requirements.txt
uvicorn main:app --reload
```

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ:

* —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–∞—è **Java**
* –¥–æ—Å—Ç—É–ø–Ω—ã–π **PlantUML**
* –¥–æ—Å—Ç—É–ø –∫ **OpenAI‚Äë—Å–æ–≤–º–µ—Å—Ç–∏–º–æ–º—É LLM endpoint**

---

# ‚öôÔ∏è –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ:

```env
OPENAI_BASE_URL=
OPENAI_API_KEY=
```

–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –¥–ª—è production:

```env
LOG_LEVEL=info
MAX_FILE_MB=5
```

---

# üì° API

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è

```
GET /api/health
```

–û—Ç–≤–µ—Ç:

```json
{ "status": "ok" }
```

---

## CSV ‚Üí PNG

```
POST /api/upload-csv
Content-Type: multipart/form-data
```

–û—Ç–≤–µ—Ç:

```json
{
  "result": {
    "png_base64": "..."
  }
}
```

–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:

* —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ ‚â§ **5 MB**
* CSV –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å **—à–∞–≥–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞**
* –∫–æ–ª–æ–Ω–∫–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –∏ —à–∞–≥–∞ **–æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏**

---

## Diagram ‚Üí Table

```
POST /api/upload-diagram
Content-Type: multipart/form-data
```

–û—Ç–≤–µ—Ç:

```json
{
  "result": {
    "filename": "diagram.png",
    "source_type": "image",
    "raw": "markdown table"
  }
}
```

–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:

* –¥–æ **25 —ç–ª–µ–º–µ–Ω—Ç–æ–≤** –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
* —Ç–æ—á–Ω–æ—Å—Ç—å –∑–∞–≤–∏—Å–∏—Ç –æ—Ç **–∫–∞—á–µ—Å—Ç–≤–∞ –¥–∏–∞–≥—Ä–∞–º–º—ã**

---

# üñ• Web‚Äë–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

–°—Ç—Ä–∞–Ω–∏—Ü—ã:

* `/` ‚Äî –≥–ª–∞–≤–Ω–∞—è
* `/upload-diagram` ‚Äî –∞–Ω–∞–ª–∏–∑ –¥–∏–∞–≥—Ä–∞–º–º—ã
* `/upload-csv` ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∏–∞–≥—Ä–∞–º–º—ã –∏–∑ CSV

–§—Ä–æ–Ω—Ç–µ–Ω–¥:

* —á–∏—Å—Ç—ã–π **HTML + vanilla JS**
* –±–µ–∑ —Å–±–æ—Ä—â–∏–∫–æ–≤
* –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π CSS

---

# üß† AI‚Äë–ø–æ–¥—Ö–æ–¥

–ü—Ä–∏–Ω—Ü–∏–ø—ã:

* **–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã** –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏
* **—Å—Ç—Ä–æ–≥–∏–µ —Ñ–æ—Ä–º–∞—Ç—ã –≤—ã–≤–æ–¥–∞** (PlantUML / CSV / Markdown)
* –∑–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
* **–∑–∞–ø—Ä–µ—Ç –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–π –ø–µ—Ä–µ—Ö–æ–¥–æ–≤** –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ –¥–∏–∞–≥—Ä–∞–º–º

–ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è:

* –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
* reverse‚Äëengineering BPMN
* low‚Äëcode / workflow‚Äë–ø–ª–∞—Ç—Ñ–æ—Ä–º
* –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö developer‚Äë–ø–æ—Ä—Ç–∞–ª–æ–≤

---

# üîí –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

* —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –¥–æ **5 MB**
* –∫–∞—á–µ—Å—Ç–≤–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∑–∞–≤–∏—Å–∏—Ç –æ—Ç **–≤–∏–∑—É–∞–ª—å–Ω–æ–π —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏**
* –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∞ –Ω—É–∂–µ–Ω **Java runtime**
* –ø–æ–∫–∞ –Ω–µ—Ç **–æ—á–µ—Ä–µ–¥–µ–π —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á**

---

# üß© –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

**Backend**

* FastAPI
* OpenAI‚Äëcompatible SDK
* pandas
* PlantUML + Java

**AI**

* Qwen3‚ÄëVL (multimodal)

**Infra**

* Docker / Docker Compose

**Frontend**

* HTML
* Vanilla JavaScript
* CSS

---

# üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è **MIT License**.

---
